<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-15.0 docs-doc-page docs-doc-id-guides/troubleshooting" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>Troubleshooting | jest-preset-angular</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:url content=https://thymikee.github.io/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/troubleshooting /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=docusaurus_version content=15.0 /><meta data-rh=true name=docusaurus_tag content=docs-default-15.0 /><meta data-rh=true name=docsearch:version content=15.0 /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-15.0 /><meta data-rh=true property=og:title content="Troubleshooting | jest-preset-angular"/><meta data-rh=true name=description content="You can check Jest troubleshooting guide"/><meta data-rh=true property=og:description content="You can check Jest troubleshooting guide"/><link data-rh=true rel=icon href=/jest-preset-angular/pr-preview/pr-3609/img/logo.svg /><link data-rh=true rel=canonical href=https://thymikee.github.io/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/troubleshooting /><link data-rh=true rel=alternate href=https://thymikee.github.io/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/troubleshooting hreflang=en /><link data-rh=true rel=alternate href=https://thymikee.github.io/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/troubleshooting hreflang=x-default /><link data-rh=true rel=preconnect href=https://2L8AIIEZVK-dsn.algolia.net crossorigin=anonymous /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://thymikee.github.io/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/troubleshooting","name":"Troubleshooting","position":1}]}</script><link rel=search type=application/opensearchdescription+xml title=jest-preset-angular href=/jest-preset-angular/pr-preview/pr-3609/opensearch.xml><link rel=icon href=/jest-preset-angular/pr-preview/pr-3609/img/logo.svg><link rel=manifest href=/jest-preset-angular/pr-preview/pr-3609/jest-preset-angular/manifest.json><meta name=theme-color content="rgb(37, 194, 160)"><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=#000><link rel=apple-touch-icon href=/jest-preset-angular/pr-preview/pr-3609/img/logo.png><link rel=mask-icon href=/jest-preset-angular/pr-preview/pr-3609/img/logo.svg color="rgb(62, 204, 94)"><meta name=msapplication-TileImage content=/jest-preset-angular/pr-preview/pr-3609/img/logo.png><meta name=msapplication-TileColor content=#000><link rel=stylesheet href=/jest-preset-angular/pr-preview/pr-3609/assets/css/styles.e8884938.css /><script src=/jest-preset-angular/pr-preview/pr-3609/assets/js/runtime~main.2f70a83e.js defer></script><script src=/jest-preset-angular/pr-preview/pr-3609/assets/js/main.432a9c1e.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" role=banner><div class=announcementBarPlaceholder_vyr4></div><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like jest-preset-angular, give it a star on <a target=_blank rel="noopener noreferrer" href=https://github.com/thymikee/jest-preset-angular>GitHub</a>! ⭐️</div><button type=button aria-label=Close class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width=14 height=14><g stroke=currentColor stroke-width=3.1><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"/></g></svg></button></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/jest-preset-angular/pr-preview/pr-3609/><div class=navbar__logo><img src=/jest-preset-angular/pr-preview/pr-3609/img/logo.svg alt="jest-preset-angular logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/jest-preset-angular/pr-preview/pr-3609/img/logo.svg alt="jest-preset-angular logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div><b class="navbar__title text--truncate">jest-preset-angular</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/jest-preset-angular/pr-preview/pr-3609/docs>Docs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class=navbar__link aria-haspopup=true aria-expanded=false role=button href=/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/troubleshooting>15.0</a><ul class=dropdown__menu><li><a class=dropdown__link href=/jest-preset-angular/pr-preview/pr-3609/docs/next/guides/troubleshooting>Next</a><li><a class=dropdown__link href=/jest-preset-angular/pr-preview/pr-3609/docs/guides/troubleshooting>16.x</a><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/troubleshooting>15.0</a><li><a class=dropdown__link href=/jest-preset-angular/pr-preview/pr-3609/docs/14.x/guides/troubleshooting>14.x</a><li><a class=dropdown__link href=/jest-preset-angular/pr-preview/pr-3609/versions>All versions</a></ul></div><a href=https://github.com/thymikee/jest-preset-angular target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts=Meta+k><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 24 24" aria-hidden=true><circle cx=11 cy=11 r=8 stroke=currentColor fill=none stroke-width=1.4 /><path d="m21 21-4.3-4.3" stroke=currentColor fill=none stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/jest-preset-angular/pr-preview/pr-3609/><img src=/jest-preset-angular/pr-preview/pr-3609/img/logo.svg alt="jest-preset-angular logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/jest-preset-angular/pr-preview/pr-3609/img/logo.svg alt="jest-preset-angular logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/><b>jest-preset-angular</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/jest-preset-angular/pr-preview/pr-3609/docs/15.0><span title=jest-preset-angular class=categoryLinkLabel_W154>jest-preset-angular</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/jest-preset-angular/pr-preview/pr-3609/docs/15.0/getting-started/installation><span title="Getting Started" class=categoryLinkLabel_W154>Getting Started</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/angular-13+><span title=Guides class=categoryLinkLabel_W154>Guides</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/angular-13+><span title="Angular >=13" class=linkLabel_WmDU>Angular >=13</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/esm-support><span title="ESM Support" class=linkLabel_WmDU>ESM Support</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/jsdom-environment><span title="JSDOM environment" class=linkLabel_WmDU>JSDOM environment</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/snapshot-testing><span title="Snapshot testing" class=linkLabel_WmDU>Snapshot testing</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/using-with-babel><span title="Using with Babel" class=linkLabel_WmDU>Using with Babel</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/absolute-imports><span title="Absolute Imports" class=linkLabel_WmDU>Absolute Imports</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/troubleshooting><span title=Troubleshooting class=linkLabel_WmDU>Troubleshooting</span></a></ul></ul></nav><button type=button title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role=alert><div>This is documentation for <!-- -->jest-preset-angular<!-- --> <b>15.0</b>, which is no longer actively maintained.</div><div class=margin-top--md>For up-to-date documentation, see the <b><a href=/jest-preset-angular/pr-preview/pr-3609/docs/guides/troubleshooting>latest version</a></b> (<!-- -->16.x<!-- -->).</div></div><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/jest-preset-angular/pr-preview/pr-3609/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Guides</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>Troubleshooting</span></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 15.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Troubleshooting</h1></header><p>You can check Jest <a href=https://jestjs.io/docs/en/troubleshooting target=_blank rel="noopener noreferrer" class="">troubleshooting guide</a></p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=common-issues>Common issues<a href=#common-issues class=hash-link aria-label="Direct link to Common issues" title="Direct link to Common issues" translate=no>​</a></h2>
<p>Problems may arise if you're using custom builds (this preset is tailored for <code>angular-cli</code> as firstly priority). Please be advised that every entry in default configuration may be overridden to best suite your app's needs.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=cant-resolve-all-parameters-for-someclass>Can't resolve all parameters for SomeClass(?)<a href=#cant-resolve-all-parameters-for-someclass class=hash-link aria-label="Direct link to Can't resolve all parameters for SomeClass(?)" title="Direct link to Can't resolve all parameters for SomeClass(?)" translate=no>​</a></h3>
<p>With Angular 8 and higher, a <a href=https://github.com/thymikee/jest-preset-angular/issues/288 target=_blank rel="noopener noreferrer" class="">change to the way the Angular CLI works</a> may be causing your metadata to be lost. You can update your <code>tsconfig.spec.json</code> to include the <code>emitDecoratorMetadata</code> compiler option:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>tsconfig.spec.json</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">{</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  "compilerOptions": {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    "emitDecoratorMetadata": true</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br/></span></code></pre></div></div>
<p>In general, this is related to <code>Angular</code>'s reflection and also depends on a reflection library, as e. g. included in <code>core-js</code>. We use our own minimal reflection that satisfy <code>Angular</code>'s current requirements, but in case these change, you can install <code>core-js</code> and import the reflection library in your <code>setup-jest.ts</code>:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>setup-jest.ts</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'core-js/es/reflect'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'core-js/proposals/reflect-metadata'</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<p>Note that this might also be related to other issues with the dependency injection and parameter type reflection.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=input-bindings-are-not-reflected-into-fixture-when-changedetectionstrategyonpush-is-used>@Input() bindings are not reflected into fixture when <code>ChangeDetectionStrategy.OnPush</code> is used<a href=#input-bindings-are-not-reflected-into-fixture-when-changedetectionstrategyonpush-is-used class=hash-link aria-label="Direct link to input-bindings-are-not-reflected-into-fixture-when-changedetectionstrategyonpush-is-used" title="Direct link to input-bindings-are-not-reflected-into-fixture-when-changedetectionstrategyonpush-is-used" translate=no>​</a></h3>
<p>This issue is not related to Jest, <a href=https://github.com/angular/angular/issues/12313 target=_blank rel="noopener noreferrer" class="">it's a known Angular bug</a></p>
<p>To mitigate this, you need to wrap your component under test, into some container component with default change detection strategy (<code>ChangeDetectionStrategy.Default</code>) and pass props through it, or overwrite change detection strategy within <code>TestBed</code> setup, if it's not critical for the test.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>some.component.spec.ts</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>beforeEach</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>async</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  TestBed</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>configureTestingModule</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> declarations</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PizzaItemComponent</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>overrideComponent</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">PizzaItemComponent</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      set</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> changeDetection</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> ChangeDetectionStrategy</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Default </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>compileComponents</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=the-animation-trigger-transformmenu-has-failed>The animation trigger "transformMenu" has failed<a href=#the-animation-trigger-transformmenu-has-failed class=hash-link aria-label='Direct link to The animation trigger "transformMenu" has failed' title='Direct link to The animation trigger "transformMenu" has failed' translate=no>​</a></h3>
<p>The currently used JSDOM version handles this, but older versions used before v7 of this preset was missing transform property. To patch it for Angular Material, use this workaround.</p>
<p>Add this to your global mock file</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>jest-global-mocks.ts</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">Object</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>defineProperty</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">document</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">body</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">style</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'transform'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function-variable function" style=color:#d73a49>value</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      enumerable</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>true</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      configurable</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>true</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<p>Reference: <a href=https://github.com/angular/material2/issues/7101 target=_blank rel="noopener noreferrer" class="">https://github.com/angular/material2/issues/7101</a></p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=unexpected-token-importexportother>Unexpected token [import|export|other]<a href=#unexpected-token-importexportother class=hash-link aria-label="Direct link to Unexpected token [import|export|other]" title="Direct link to Unexpected token [import|export|other]" translate=no>​</a></h3>
<p>This means, that a file is not transformed through <code>TypeScript</code> compiler, e.g. because it is a <code>JS</code> file with <code>TS</code> syntax, or
it is published to npm as uncompiled source files. Here's what you can do. A typical Jest error is like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">({"Object.&lt;anonymous>":function(module,exports,require,__dirname,__filename,jest){import * as i0 from '@angular/core';</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                                                                                                                                           ^^^^^^</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    SyntaxError: Cannot use import statement outside a module</span><br/></span></code></pre></div></div>
<p>To fix the issue, one needs to adjust <code>transformIgnorePatterns</code> whitelist:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>jest.config.ts</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>type</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> Config </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'jest'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>export</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>default</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// ...other options</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  transformIgnorePatterns</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>'node_modules/(?!@angular|@ngrx)'</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> satisfies Config</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<p>By default, Jest doesn't transform <code>node_modules</code>, because they should be valid JavaScript files. However, it happens that
library authors assume that you'll compile their sources. So you have to tell this to Jest explicitly.
Above snippet means that <code>@angular</code>, <code>@ngrx</code> will be transformed, even though they're <code>node_modules</code>.</p>
<p>If the dependency causing the issue is a sub dependency of a <code>node_modules</code> packages or a module designed to be used with nodeJS, a custom resolver could be required to fix the issue. <a href=#resolver-needed-for-some-javascript-library-or-nested-dependencies class="">See below</a> for more information.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=allow-vendor-libraries-like-jquery-etc>Allow vendor libraries like jQuery, etc...<a href=#allow-vendor-libraries-like-jquery-etc class=hash-link aria-label="Direct link to Allow vendor libraries like jQuery, etc..." title="Direct link to Allow vendor libraries like jQuery, etc..." translate=no>​</a></h3>
<p>The same like normal Jest configuration, you can load jQuery in your Jest setup file. For example your Jest setup file is <code>setup-jest.ts</code> you can declare jQuery:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>setup-jest.ts</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">window</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">$ </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>require</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'path/to/jquery'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<p>or</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>setup-jest.ts</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> $ </span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'jquery'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">global</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">$ </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> global</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">jQuery </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> $</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<p>The same declaration can be applied to other vendor libraries.</p>
<p>Reference: <a href=https://github.com/facebook/jest/issues/708 target=_blank rel="noopener noreferrer" class="">https://github.com/facebook/jest/issues/708</a></p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=coverage-fail-but-tests-pass>Coverage fail but tests pass<a href=#coverage-fail-but-tests-pass class=hash-link aria-label="Direct link to Coverage fail but tests pass" title="Direct link to Coverage fail but tests pass" translate=no>​</a></h3>
<p>This issue happens because Jest uses <code>Babel</code> behind the screen to create coverage reporter. To fix this issue, one can do the following:</p>
<ul>
<li class="">Install <code>babel-jest</code>, <code>@babel/core</code> and <code>@babel/preset-env</code></li>
<li class="">Create a <code>.babelrc</code> at the same place where Jest config file locates and define the necessary <code>Babel</code> plugins.
For example</li>
</ul>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>.babelrc</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">{</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  // this plugin will fix issue with class inheritance</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  "plugins": ["@babel/plugin-transform-classes"]</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br/></span></code></pre></div></div>
<ul>
<li class="">Define the usage of <code>Babel</code> in Jest config via <code>ts-jest</code> option, for example</li>
</ul>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>jest.config.ts</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>type</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> Config </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'jest'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>export</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>default</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  transform</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string-property property" style=color:#36acaa>'^.+\\.(ts|js|mjs|html|svg)$'</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token string" style=color:#e3116c>'jest-preset-angular'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        babelConfig</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>true</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> satisfies Config</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=resolver-needed-for-some-javascript-library-or-nested-dependencies>Resolver needed for some javascript library or nested dependencies<a href=#resolver-needed-for-some-javascript-library-or-nested-dependencies class=hash-link aria-label="Direct link to Resolver needed for some javascript library or nested dependencies" title="Direct link to Resolver needed for some javascript library or nested dependencies" translate=no>​</a></h3>
<p>This can happen in two identified cases.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=javascript-library>Javascript library<a href=#javascript-library class=hash-link aria-label="Direct link to Javascript library" title="Direct link to Javascript library" translate=no>​</a></h4>
<p>When using a javascript SDK/Library in Angular, some javascript methods could fail to be properly rendered in tests. Some examples are the <code>firebase</code> and <code>firebase/compat</code> SDK.</p>
<p>A typical error could appear as:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">TypeError: Cannot read properties of undefined (reading 'FacebookAuthProvider')</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    import firebase from 'firebase/compat/app';</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    > export const facebookAuthProvider = new firebase.auth.FacebookAuthProvider();</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=nested-dependency-node_modules-package-within-another-package-node_nodules>Nested dependency (<code>node_modules</code> package within another package <code>node_nodules</code>)<a href=#nested-dependency-node_modules-package-within-another-package-node_nodules class=hash-link aria-label="Direct link to nested-dependency-node_modules-package-within-another-package-node_nodules" title="Direct link to nested-dependency-node_modules-package-within-another-package-node_nodules" translate=no>​</a></h4>
<p>Some nested dependency tree could trigger some errors while running the tests because some bundles (especially ESM ones) could be somehow errored. An example is the <code>@angular/fire</code> package which uses the <code>@firebase/firestore</code> package.</p>
<p>A typical error could appear as:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">node_modules\@angular\fire\node_modules\@firebase\firestore\dist\index.esm2017.js:12705</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                    function (t, e) {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                    ^^^^^^^^</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    SyntaxError: Function statements require a function name</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=resolution>Resolution<a href=#resolution class=hash-link aria-label="Direct link to Resolution" title="Direct link to Resolution" translate=no>​</a></h4>
<p>In these cases, a <code>transformIgnorePatterns</code> whitelisting could not fix the issue. The solution here is to use a custom <code>resolver</code>. You may or may not need to remove entries from <code>transformIgnorePatterns</code> whitelisting.</p>
<p>Here is an example of a resolver which would fix <code>firebase</code> related packages.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>jest.resolver.ts</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>type</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> SyncResolver </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'jest-resolve'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> myResolver</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token function-variable function" style=color:#d73a49>SyncResolver</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">path</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> options</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// Call the defaultResolver, so we leverage its cache, error handling, etc.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> options</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>defaultResolver</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">path</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>...</span><span class="token plain">options</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// Use packageFilter to process parsed `package.json` before the resolution (see https://www.npmjs.com/package/resolve#resolveid-opts-cb)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function-variable function" style=color:#d73a49>packageFilter</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">pkg</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> pkgNamesToTarget </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> </span><span class="token class-name">Set</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>'rxjs'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>'@firebase/auth'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>'@firebase/storage'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>'@firebase/functions'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>'@firebase/database'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>'@firebase/auth-compat'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>'@firebase/database-compat'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>'@firebase/app-compat'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>'@firebase/firestore'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>'@firebase/firestore-compat'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>'@firebase/messaging'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>'@firebase/util'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>'firebase'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">pkgNamesToTarget</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>has</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">pkg</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">name</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>// console.log('>>>', pkg.name)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>delete</span><span class="token plain"> pkg</span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>'exports'</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>delete</span><span class="token plain"> pkg</span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>'module'</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> pkg</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>export</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> myResolver</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockTitle_OeMC>jest.config.ts</div><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>type</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> Config </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'jest'</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>export</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>default</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>//...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  resolver</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'&lt;rootDir>/src/jest.resolver.ts'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>//...</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> satisfies Config</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id=inject-dependencies-with-typescript-interface-or-exported-namespace>Inject dependencies with TypeScript interface or exported namespace<a href=#inject-dependencies-with-typescript-interface-or-exported-namespace class=hash-link aria-label="Direct link to Inject dependencies with TypeScript interface or exported namespace" title="Direct link to Inject dependencies with TypeScript interface or exported namespace" translate=no>​</a></h3>
<p>Please use Angular <a href=https://angular.dev/api/core/inject target=_blank rel="noopener noreferrer" class="">inject</a> instead of <a href=https://angular.dev/api/core/Inject target=_blank rel="noopener noreferrer" class="">@Inject</a>.
This is because <code>jest-preset-angular</code> has caveat when working with class constructor and decorator.</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href=https://github.com/thymikee/jest-preset-angular/edit/main/website/versioned_docs/version-15.0/guides/troubleshooting.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class=theme-last-updated>Last updated<!-- --> on <b><time datetime=2026-02-10T08:05:44.000Z itemprop=dateModified>Feb 10, 2026</time></b> by <b>renovate[bot]</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/jest-preset-angular/pr-preview/pr-3609/docs/15.0/guides/absolute-imports><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Absolute Imports</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#common-issues class="table-of-contents__link toc-highlight">Common issues</a><ul><li><a href=#cant-resolve-all-parameters-for-someclass class="table-of-contents__link toc-highlight">Can't resolve all parameters for SomeClass(?)</a><li><a href=#input-bindings-are-not-reflected-into-fixture-when-changedetectionstrategyonpush-is-used class="table-of-contents__link toc-highlight">@Input() bindings are not reflected into fixture when <code>ChangeDetectionStrategy.OnPush</code> is used</a><li><a href=#the-animation-trigger-transformmenu-has-failed class="table-of-contents__link toc-highlight">The animation trigger "transformMenu" has failed</a><li><a href=#unexpected-token-importexportother class="table-of-contents__link toc-highlight">Unexpected token [import|export|other]</a><li><a href=#allow-vendor-libraries-like-jquery-etc class="table-of-contents__link toc-highlight">Allow vendor libraries like jQuery, etc...</a><li><a href=#coverage-fail-but-tests-pass class="table-of-contents__link toc-highlight">Coverage fail but tests pass</a><li><a href=#resolver-needed-for-some-javascript-library-or-nested-dependencies class="table-of-contents__link toc-highlight">Resolver needed for some javascript library or nested dependencies</a><li><a href=#inject-dependencies-with-typescript-interface-or-exported-namespace class="table-of-contents__link toc-highlight">Inject dependencies with TypeScript interface or exported namespace</a></ul></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Learn</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/jest-preset-angular/pr-preview/pr-3609/docs>Introduction</a><li class=footer__item><a class=footer__link-item href=/jest-preset-angular/pr-preview/pr-3609/docs/getting-started/installation>Installation</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Community</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://stackoverflow.com/questions/tagged/jest target=_blank rel="noopener noreferrer" class=footer__link-item>Jest<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://discord.gg/j6FKKQQrW9 target=_blank rel="noopener noreferrer" class=footer__link-item>Discord<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>More</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/thymikee/jest-preset-angular/ target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2026 jest-preset-angular. Built with Docusaurus.</div></div></div></footer></div></body>