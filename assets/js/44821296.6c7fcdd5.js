"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([["1058"],{5115:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>p,default:()=>g,toc:()=>h,metadata:()=>s,assets:()=>d,contentTitle:()=>c});var s=JSON.parse('{"id":"guides/snapshot-testing","title":"Snapshot testing","description":"jest-preset-angular provides several snapshot serializers to generate clearer and more human-readable snapshot.","source":"@site/versioned_docs/version-14.3/guides/snapshot-testing.md","sourceDirName":"guides","slug":"/guides/snapshot-testing","permalink":"/jest-preset-angular/docs/14.3/guides/snapshot-testing","draft":false,"unlisted":false,"editUrl":"https://github.com/thymikee/jest-preset-angular/edit/main/website/versioned_docs/version-14.3/guides/snapshot-testing.md","tags":[],"version":"14.3","lastUpdatedBy":"renovate[bot]","lastUpdatedAt":1756069107000,"frontMatter":{"id":"snapshot-testing","title":"Snapshot testing"},"sidebar":"docs","previous":{"title":"Configure other JSDOM versions","permalink":"/jest-preset-angular/docs/14.3/guides/jsdom-version"},"next":{"title":"Using with Babel","permalink":"/jest-preset-angular/docs/14.3/guides/using-with-babel"}}'),i=t(5893),r=t(65),l=t(7057),a=t(4250),o=t(1924);let p={id:"snapshot-testing",title:"Snapshot testing"},c=void 0,d={},h=[{value:"Snapshot serializers",id:"snapshot-serializers",level:2},{value:"Remove html comments (<code>html-comment</code>)",id:"remove-html-comments-html-comment",level:3},{value:"Examples:",id:"examples",level:4},{value:"Display component HTML (<code>ng-snapshot</code>)",id:"display-component-html-ng-snapshot",level:3},{value:"Parameters",id:"parameters",level:4},{value:"Examples:",id:"examples-1",level:4},{value:"With options",id:"with-options",level:4},{value:"Remove Angular attributes (<code>no-ng-attributes</code>)",id:"remove-angular-attributes-no-ng-attributes",level:3},{value:"Examples:",id:"examples-2",level:4}];function m(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"jest-preset-angular"})," provides several snapshot serializers to generate clearer and more human-readable snapshot."]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"BY DEFAULT"}),", the ",(0,i.jsx)(n.a,{href:"/jest-preset-angular/docs/14.3/getting-started/presets",children:"preset"})," provides all of the snapshot serializers below."]})}),"\n",(0,i.jsx)(n.h2,{id:"snapshot-serializers",children:"Snapshot serializers"}),"\n","\n",(0,i.jsx)(o.Z,{toc:h.slice(1)}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h3,{id:"remove-html-comments-html-comment",children:["Remove html comments (",(0,i.jsx)(n.code,{children:"html-comment"}),")"]}),"\n",(0,i.jsx)(n.p,{children:"Allow removing all the comments in the component HTML in snapshot."}),"\n",(0,i.jsx)(n.h4,{id:"examples",children:"Examples:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"In Jest config file"}),"\n"]}),"\n",(0,i.jsxs)(l.Z,{groupId:"code-examples",children:[(0,i.jsx)(a.Z,{value:"typescript-cjs",label:"TypeScript CJS",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="jest.config.ts" tab={"label": "TypeScript CJS"}',children:"import type { Config } from 'jest';\n\nconst jestConfig: Config = {\n  //[...]\n  snapshotSerializers: ['jest-preset-angular/build/serializers/html-comment'],\n  //[...]\n};\n\nexport default jestConfig;\n"})})}),(0,i.jsx)(a.Z,{value:"typescript-esm",label:"TypeScript ESM",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="jest.config.mts" tab={"label": "TypeScript ESM"}',children:"import type { Config } from 'jest';\n\nconst jestConfig: Config = {\n  //[...]\n  snapshotSerializers: ['jest-preset-angular/build/serializers/html-comment'],\n  //[...]\n};\n\nexport default jestConfig;\n"})})})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Or in setup test environment file"}),"\n"]}),"\n",(0,i.jsxs)(l.Z,{groupId:"code-examples",children:[(0,i.jsx)(a.Z,{value:"typescript-cjs",label:"TypeScript CJS",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="jest.config.ts" tab={"label": "TypeScript CJS"}',children:"import type { Config } from 'jest';\n\nconst jestConfig: Config = {\n  //[...]\n  setupFilesAfterEnv: ['./setup-jest.ts'],\n  //[...]\n};\n"})})}),(0,i.jsx)(a.Z,{value:"typescript-esm",label:"TypeScript ESM",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="jest.config.mts" tab={"label": "TypeScript ESM"}',children:"import type { Config } from 'jest';\n\nconst jestConfig: Config = {\n  //[...]\n  setupFilesAfterEnv: ['./setup-jest.ts'],\n  //[...]\n};\n"})})})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="setup-jest.ts"',children:"import removeHtmlCommentsSerializer from 'jest-preset-angular/build/serializers/html-comment';\n\nexpect.addSnapshotSerializer(removeHtmlCommentsSerializer);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Or in individual test files"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="foo.component.spec.ts"',children:"import removeHtmlCommentsSerializer from 'jest-preset-angular/build/serializers/html-comment';\n\nexpect.addSnapshotSerializer(removeHtmlCommentsSerializer);\n\nit('should work', () => {\n  //[...]\n});\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"display-component-html-ng-snapshot",children:["Display component HTML (",(0,i.jsx)(n.code,{children:"ng-snapshot"}),")"]}),"\n",(0,i.jsx)(n.p,{children:"Allow displaying component HTML with data in snapshot."}),"\n",(0,i.jsx)(n.h4,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["options(",(0,i.jsx)(n.strong,{children:"optional"}),"):","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"omitAllCompAttrs: remove all component DOM attributes"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"type NgSnapshotOptions = {\n  omitAllCompAttrs?: boolean;\n};\n"})}),"\n",(0,i.jsx)(n.h4,{id:"examples-1",children:"Examples:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"In Jest config"}),"\n"]}),"\n",(0,i.jsxs)(l.Z,{groupId:"code-examples",children:[(0,i.jsx)(a.Z,{value:"typescript-cjs",label:"TypeScript CJS",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="jest.config.ts" tab={"label": "TypeScript CJS"}',children:"import type { Config } from 'jest';\n\nconst jestConfig: Config = {\n  //[...]\n  snapshotSerializers: ['jest-preset-angular/build/serializers/ng-snapshot'],\n  //[...]\n};\n\nexport default jestConfig;\n"})})}),(0,i.jsx)(a.Z,{value:"typescript-esm",label:"TypeScript ESM",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="jest.config.mts" tab={"label": "TypeScript ESM"}',children:"import type { Config } from 'jest';\n\nconst jestConfig: Config = {\n  //[...]\n  snapshotSerializers: ['jest-preset-angular/build/serializers/ng-snapshot'],\n  //[...]\n};\n\nexport default jestConfig;\n"})})})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Or in setup test environment file"}),"\n"]}),"\n",(0,i.jsxs)(l.Z,{groupId:"code-examples",children:[(0,i.jsx)(a.Z,{value:"typescript-cjs",label:"TypeScript CJS",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="jest.config.ts" tab={"label": "TypeScript CJS"}',children:"import type { Config } from 'jest';\n\nconst jestConfig: Config = {\n  //[...]\n  setupFilesAfterEnv: ['./setup-jest.ts'],\n  //[...]\n};\n"})})}),(0,i.jsx)(a.Z,{value:"typescript-esm",label:"TypeScript ESM",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="jest.config.mts" tab={"label": "TypeScript ESM"}',children:"import type { Config } from 'jest';\n\nconst jestConfig: Config = {\n  //[...]\n  setupFilesAfterEnv: ['./setup-jest.ts'],\n  //[...]\n};\n"})})})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="setup-jest.ts"',children:"import componentSnapshotSerializer from 'jest-preset-angular/build/serializers/ng-snapshot';\n\nexpect.addSnapshotSerializer(componentSnapshotSerializer);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Or in individual test files"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="foo.component.spec.ts"',children:"import componentSnapshotSerializer from 'jest-preset-angular/build/serializers/ng-snapshot';\n\nexpect.addSnapshotSerializer(componentSnapshotSerializer);\n\nit('should work', () => {\n  //[...]\n});\n"})}),"\n",(0,i.jsx)(n.h4,{id:"with-options",children:"With options"}),"\n",(0,i.jsxs)(n.admonition,{title:"Effective priority",type:"info",children:[(0,i.jsx)(n.p,{children:"The configured serializers will have affect in this order:"}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"Jest config"})," -> ",(0,i.jsx)(n.code,{children:"setup files"})," -> ",(0,i.jsx)(n.code,{children:"test files"})]}),(0,i.jsx)(n.p,{children:"The later the higher priority. This means that with the same serializer, the later one will override the configuration\nof the previous one in the chain."})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"In setup files:"}),"\n"]}),"\n",(0,i.jsxs)(l.Z,{groupId:"code-examples",children:[(0,i.jsx)(a.Z,{value:"typescript-cjs",label:"TypeScript CJS",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="jest.config.ts" tab={"label": "TypeScript CJS"}',children:"import type { Config } from 'jest';\n\nconst jestConfig: Config = {\n  //[...]\n  setupFilesAfterEnv: ['./setup-jest.ts'],\n  //[...]\n};\n\nexport default jestConfig;\n"})})}),(0,i.jsx)(a.Z,{value:"typescript-esm",label:"TypeScript ESM",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="jest.config.mts" tab={"label": "TypeScript ESM"}',children:"import type { Config } from 'jest';\n\nconst jestConfig: Config = {\n  //[...]\n  setupFilesAfterEnv: ['./setup-jest.ts'],\n  //[...]\n};\n\nexport default jestConfig;\n"})})})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="setup-jest.ts"',children:"import componentSnapshotSerializer from 'jest-preset-angular/build/serializers/ng-snapshot';\n\nexpect.addSnapshotSerializer({\n  print: (val, print, indent, options, colors) =>\n    componentSnapshotSerializer.print(\n      val,\n      print,\n      indent,\n      {\n        ...options,\n        omitAllCompAttrs: true,\n      },\n      colors,\n    ),\n  test: componentSnapshotSerializer.test,\n});\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"or in individual test files:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="foo.component.spec.ts"',children:"import componentSnapshotSerializer from 'jest-preset-angular/build/serializers/ng-snapshot';\n\nexpect.addSnapshotSerializer({\n  print: (val, print, indent, options, colors) =>\n    componentSnapshotSerializer.print(\n      val,\n      print,\n      indent,\n      {\n        ...options,\n        omitAllCompAttrs: true,\n      },\n      colors,\n    ),\n  test: componentSnapshotSerializer.test,\n});\n\nit('should work', () => {\n  //[...]\n});\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"remove-angular-attributes-no-ng-attributes",children:["Remove Angular attributes (",(0,i.jsx)(n.code,{children:"no-ng-attributes"}),")"]}),"\n",(0,i.jsxs)(n.p,{children:["Allow removing attributes generated by Angular fixture, like ",(0,i.jsx)(n.code,{children:"ng-reflect-*"}),", ",(0,i.jsx)(n.code,{children:'ng-version="*"'}),", ",(0,i.jsx)(n.code,{children:"_ngcontent-c*"})," etc., from component snapshot"]}),"\n",(0,i.jsx)(n.h4,{id:"examples-2",children:"Examples:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"In Jest config"}),"\n"]}),"\n",(0,i.jsxs)(l.Z,{groupId:"code-examples",children:[(0,i.jsx)(a.Z,{value:"typescript-cjs",label:"TypeScript CJS",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="jest.config.ts" tab={"label": "TypeScript CJS"}',children:"import type { Config } from 'jest';\n\nconst jestConfig: Config = {\n  //[...]\n  snapshotSerializers: ['jest-preset-angular/build/serializers/no-ng-attributes'],\n  //[...]\n};\n\nexport default jestConfig;\n"})})}),(0,i.jsx)(a.Z,{value:"typescript-esm",label:"TypeScript ESM",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="jest.config.mts" tab={"label": "TypeScript ESM"}',children:"import type { Config } from 'jest';\n\nconst jestConfig: Config = {\n  //[...]\n  snapshotSerializers: ['jest-preset-angular/build/serializers/no-ng-attributes'],\n  //[...]\n};\n\nexport default jestConfig;\n"})})})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Or in setup test environment file"}),"\n"]}),"\n",(0,i.jsxs)(l.Z,{groupId:"code-examples",children:[(0,i.jsx)(a.Z,{value:"typescript-cjs",label:"TypeScript CJS",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="jest.config.ts" tab={"label": "TypeScript CJS"}',children:"import type { Config } from 'jest';\n\nconst jestConfig: Config = {\n  //[...]\n  setupFilesAfterEnv: ['./setup-jest.ts'],\n  //[...]\n};\n"})})}),(0,i.jsx)(a.Z,{value:"typescript-esm",label:"TypeScript ESM",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="jest.config.mts" tab={"label": "TypeScript ESM"}',children:"import type { Config } from 'jest';\n\nconst jestConfig: Config = {\n  //[...]\n  setupFilesAfterEnv: ['./setup-jest.ts'],\n  //[...]\n};\n"})})})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="setup-jest.ts"',children:"import removeNgAttributes from 'jest-preset-angular/build/serializers/no-ng-attributes';\n\nexpect.addSnapshotSerializer(removeNgAttributes);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Or in individual test files"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="foo.component.spec.ts"',children:"import removeNgAttributes from 'jest-preset-angular/build/serializers/no-ng-attributes';\n\nexpect.addSnapshotSerializer(removeNgAttributes);\n\nit('should work', () => {\n  //[...]\n});\n"})})]})}function g(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(m,{...e})}):m(e)}}}]);